import{a as m,q as I,c as e,M as q,s as z,v as H,w as V,x as W,d as h,e as P,L as K,V as J,H as N,F as k,T as y,j as S,B as C,N as B,O as Q,z as X,y as Y,D as Z,Q as D,R as M,U as ee,W as re,t as v,S as te,C as ne,n as f,g as se}from"./index-5d8b550a.js";import{T as ae}from"./image-e02ea580.js";import{M as ie}from"./manageResourceBasePage-124a7105.js";import{N as d,C as A,B as le,g as oe,A as G,a as E}from"./baseCrudService-f58e06f5.js";import{g as ce}from"./enumHelper-aebeeebb.js";import{g as x}from"./managePermissionService-d7f060b9.js";import"./image-ebeb0859.js";import"./popupHelper-26579962.js";const ue=v('<span class="perm-emoji"></span>',2),de=v('<span class="perm-title">&nbsp;</span>',2),ge=v("<span></span>",2),me=r=>{const[i,t]=m(d.Loading),[u,c]=m([]),[p,g]=m([]),[U,T]=m([]),[_,O]=m([]);I(()=>{r.userGuid!=null&&w(r.userGuid)});const F=n=>{const s=n.map(o=>({title:D[o],value:o}));return s.sort((o,a)=>o.title.replace("View","").replace("Manage","").localeCompare(a.title.replace("View","").replace("Manage",""))),s},w=async n=>{if(n==null||n.length<5){T([]);return}const s=await x().getPermissionsForUserGuid(n);if(s.isSuccess==!1){t(d.Error);return}const o=ce(D).filter(l=>l>0).map(l=>parseInt(l)),a=s.value;T(F(a)),O(F(o.filter(l=>a.includes(l)==!1))),t(d.Success),c(l=>l.slice(1,l.length)),g(l=>l.slice(1,l.length))},$=async n=>{c(s=>[...s,s.length]),await x().delPermissionForUser(r.userGuid,n),w(r.userGuid)},L=async n=>{g(s=>[...s,s.length]),await x().addForUser(r.userGuid,n),w(r.userGuid)},R=n=>s=>{const o=j(s.title);return e(C,{class:"perm-item noselect pointer",onClick:()=>n(s.value),get children(){return e(A,{get children(){return[(()=>{const a=ue.cloneNode(!0);return M(a,()=>o[0]),a})(),(()=>{const a=de.cloneNode(!0),l=a.firstChild;return M(a,()=>o[1],l),a})(),(()=>{const a=ge.cloneNode(!0);return M(a,()=>o[2]),ee(()=>re(a,`perm-action ${(o[2]??" ").toLowerCase()}`)),a})()]}})}})},j=n=>n.replace("appNotice","ðŸ“¢ |App Notice|").replace("app","ðŸ“² |App|").replace("cache","ðŸ’¾ |Cache|").replace("donation","ðŸ’° |Donation|").replace("feedbackForm","ðŸ’¬ |Feedback From|").replace("guideSubmission","ðŸ“‘ |Guide Submission|").replace("language","ðŸŒ |Language|").replace("licence","ðŸ›‚ |Licence|").replace("steamBranch","ðŸŒ¿ |Steam Branch|").replace("teamMember","ðŸ‘ª |Team Member|").replace("translationKey","ðŸŒ |Translation Key|").replace("translationReport","ðŸŒ |Translation Report|").replace("translation","ðŸŒ |Translation|").replace("userPermissions","ðŸ™Žâ€â™‚ï¸ |User Permissions|").replace("users","ðŸ™Žâ€â™‚ï¸ |Users|").replace("version","ðŸ“… |Versions|").split("|");return e(Z,{get opened(){return r.isOpen},size:"7xl",get onClose(){return r.onClose},get children(){return[e(q,{}),e(z,{get children(){return[e(H,{}),e(V,{get children(){return r.title}}),e(W,{get children(){return[e(h,{get when(){return i()==d.Loading||i()==d.Pending},get children(){return e(P,{height:"25vh",get children(){return e(K,{})}})}}),e(h,{get when(){return i()==d.Error},get children(){return e(P,{children:"Error"})}}),e(h,{get when(){return i()==d.Success},get children(){return e(J,{get children(){return[e(N,{size:"xl",mb:"1em",children:"Current permissions"}),e(k,{gap:"0.5em",flexWrap:"wrap",justifyContent:"center",get children(){return[e(h,{get when(){return U().length>0},get fallback(){return e(y,{children:"No permissions"})},get children(){return e(S,{get each(){return U()},get children(){return R($)}})}}),e(S,{get each(){return p()},children:n=>e(C,{class:"perm-item",get children(){return e(A,{get children(){return e(P,{get children(){return e(B,{})}})}})}})})]}}),e(Q,{mt:"3em"}),e(N,{size:"xl",mt:"2em",mb:"1em",children:"Permissions to Add"}),e(k,{gap:"0.5em",flexWrap:"wrap",justifyContent:"center",get children(){return[e(h,{get when(){return _().length>0},get fallback(){return e(y,{children:"No permissions"})},get children(){return e(S,{get each(){return _()},get children(){return R(L)}})}}),e(S,{get each(){return u()},children:n=>e(C,{class:"perm-item",get children(){return e(A,{get children(){return e(P,{get children(){return e(B,{})}})}})}})})]}})]}})}})]}}),e(X,{get children(){return e(Y,{get onClick(){return r.onClose},children:"Close"})}})]}})]}})};var pe=Object.defineProperty,he=Object.getOwnPropertyDescriptor,fe=(r,i,t,u)=>{for(var c=u>1?void 0:u?he(i,t):i,p=r.length-1,g;p>=0;p--)(g=r[p])&&(c=(u?g(i,t,c):g(c))||c);return u&&c&&pe(i,t,c),c};let b=class extends le{constructor(){const r=oe();super(r.getAssistantAppsUrl())}create(r){throw new Error("ManageUserService: Method not implemented.")}read(r){throw new Error("ManageUserService: Method not implemented.")}readAll(r){return this.post(G.user,{page:r?.page??1,searchText:r?.searchText??""},E)}update(r){throw new Error("ManageUserService: Method not implemented.")}del(r){const i=`${G.user}/${r.guid}`;return this.delete(i,E)}};b=fe([te()],b);const Pe=()=>ne.get(b),Ue=()=>{const[r,i]=m();return[e(ie,{title:"Manage Users",itemName:"user",serverPagination:!0,unknownPagination:!0,disableEditAction:!0,disableGetByIdOption:!0,get crudService(){return Pe()},pageSizeOptions:[10],searchTooltip:"Searches: username & email",searchFunc:(t,u)=>t.username.includes(u),tableHeadItems:[{title:"Avatar",maxWidth:"50px",textAlign:"center"},{title:"Username"},{title:"Join Date"},{title:"Is Admin",textAlign:"center"},{title:"Is Donator",textAlign:"center"},{title:"Is Patron",textAlign:"center"}],tableRowRender:t=>[e(ae,{get url(){return t.profileImageUrl},fallbackSrc:"/assets/img/fallbackAvatar.png",borderRadius:"100% !important",maxWidth:"35px",margin:"0 auto"}),e(f,{get children(){return t.username}}),e(f,{get children(){return se(t.joinDate)}}),e(f,{textAlign:"center",get children(){return t.isAdmin?"âœ”":"âŒ"}}),e(f,{textAlign:"center",get children(){return t.isDonator?"âœ”":"âŒ"}}),e(f,{textAlign:"center",get children(){return t.isPatreon?"âœ”":"âŒ"}})],actionsPerRow:[{emoji:"ðŸ”",label:"Permissions",order:6,onClick:t=>i(t.guid)}],propToFormMappings:[]}),e(me,{title:"Manage permissions for user",get userGuid(){return r()??""},get isOpen(){return r()!=null},onClose:()=>i(void 0)})]};export{Ue as ManageUsersPage,Ue as default};
