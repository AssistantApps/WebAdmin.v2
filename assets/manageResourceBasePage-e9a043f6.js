import{ab as i,c as t,X as $,ac as Y,t as w,ad as oe,ae as ge,a as h,q as he,d as u,_ as me,af as fe,ag as we,ah as Ce,ai as xe,F as ee,j as v,aj as be,f as T,I as G,ak as Se,al as ve,am as Ie,an as $e,ao as ye,ap as Ne,aq as Pe,Z as Te,M as ke,s as Ae,v as Oe,w as Me,x as Re,z as Be,y as A,D as Ee,o as Fe,P as Le,B as b,b as _e,e as J,k as O,ar as B,E,a2 as je,as as We,a3 as He,at as De,au as pe,av as ze,aw as F,ax as L,T as _,ay as Ve,n as X,L as Ue,az as qe,R as N,H as Ge}from"./index-7285a1df.js";import{b as W,N as S,C as Z}from"./baseCrudService-b6b97e54.js";import{s as Je,t as Xe}from"./popupHelper-5405ca87.js";const Ze=e=>{try{navigator?.clipboard?.writeText?.(e),i.clear(),i.show({status:"info",title:"Copied!",description:e})}catch{}},Ke=w(`<svg><path fill="currentColor" d="M19.129,18.164l-4.518-4.52c1.152-1.373,1.852-3.143,1.852-5.077c0-4.361-3.535-7.896-7.896-7.896
								c-4.361,0-7.896,3.535-7.896,7.896s3.535,7.896,7.896,7.896c1.934,0,3.705-0.698,5.078-1.853l4.52,4.519
								c0.266,0.268,0.699,0.268,0.965,0C19.396,18.863,19.396,18.431,19.129,18.164z M8.567,15.028c-3.568,0-6.461-2.893-6.461-6.461
								s2.893-6.461,6.461-6.461c3.568,0,6.46,2.893,6.46,6.461S12.135,15.028,8.567,15.028z"></path></svg>`,4,!0),Qe=e=>t(Y,$({viewBox:"0 0 20 20"},e,{get children(){return Ke.cloneNode(!0)}}));let P=function(e){return e[e.xsmol=0]="xsmol",e[e.smol=1]="smol",e[e.medium=2]="medium",e[e.long=3]="long",e[e.xlong=4]="xlong",e}({});const Ye=e=>{const d=s=>{if(s==P.xsmol)return 1;if(s==P.smol)return 2;if(s==P.medium)return 4;if(s==P.long)return 6;if(s==P.xlong)return 12};return t(oe,{get colSpan(){return d(e.size)},get children(){return e.children}})},et=e=>t(ge,{templateColumns:{"@initial":"repeat(2, 1fr)","@md":"repeat(12, 1fr)"},gap:"$6",get children(){return e.children}});var k=(e=>(e[e.Add=0]="Add",e[e.Edit=1]="Edit",e))(k||{});const tt=e=>{const[d,s]=h(e.selectedValues??[],{equals:!1});he(()=>{s(e.selectedValues??[])});const f=a=>{s(a),e.onSelect?.(a)},l=a=>e.options.find(c=>c.value==a);return t(Te,{get children(){return[t(u,{get when(){return e.hideTitle!=!0},get children(){return t(me,{get children(){return e.title}})}}),t(fe,{get multiple(){return e.multiple},get value(){return d()},onChange:f,get children(){return[t(we,{get children(){return[t(Ce,{get children(){return e.placeholder}}),t(xe,{children:({selectedOptions:a})=>t(ee,{alignItems:"flex-start",get children(){return t(v,{each:a,children:o=>t(be,{borderRadius:5,m:"0.125em 0.25em 0.125em 0",get children(){return[t(u,{get when(){return T(()=>l(o.value)!=null)()&&l(o.value).image!=null},get children(){return t(G,{get src(){return l(o.value).image},get alt(){return l(o.value).title},borderRadius:3,height:"1em",width:"1em",mr:"0.5em"})}}),t(Se,{textAlign:"start",get children(){return o.textValue}})]}})})}})}),t(ve,{})]}}),t(Ie,{get children(){return t($e,{get children(){return t(v,{get each(){return e.options},children:a=>t(ye,{get value(){return a.value},get children(){return[t(u,{get when(){return a.image!=null},get children(){return t(G,{get src(){return a.image},get alt(){return a.title},borderRadius:5,maxHeight:"2em",maxWidth:"2em",ml:"0.5em"})}}),t(Ne,{get children(){return a.title}}),t(Pe,{})]}})})}})}})]}})]}})},nt=e=>{const d=e.wrapComp;return t(u,{get when(){return e.condition},get fallback(){return e.children},get children(){return t(d,$(()=>e.wrapProps,{get children(){return e.children}}))}})},rt=e=>t(Ee,{get opened(){return e.isOpen},size:"7xl",get onClose(){return e.onClose},get children(){return[t(ke,{}),t(Ae,{get children(){return[t(Oe,{}),t(Me,{get children(){return e.title}}),t(Re,{get children(){return e.children}}),t(Be,{get children(){return[t(A,{mt:"1em",mr:"0.5em",get onClick(){return e.onSave},children:"Save"}),t(A,{mt:"1em",colorScheme:"danger",get onClick(){return e.onClose},children:"Close"})]}})]}})]}}),K=e=>{const[d,s]=h(e.item),f=(l,a)=>{l==="json"?(console.log(JSON.parse(a)),s(o=>JSON.parse(a)),e.updateObject(JSON.parse(a))):(s(o=>({...o,[l]:a})),e.updateProperty(l,a))};return t(et,{get children(){return t(v,{get each(){return e.mappings},children:l=>{if((l.hiddenIn??[]).includes(e.mode))return null;const a=l.component,o=c=>{let C=W;for(const m of l.additional??[])C={...C,[m.prop]:m.value(c)};return C};return t(Ye,{get size(){return l.gridItemSize},get children(){return t(a,$(()=>o(d()),{get id(){return`${e.mode}-${l.property}`},get label(){return l.label},get value(){return d()[l.property]},get placeholder(){return l.placeholder},onChange:c=>f(l.property,c)}))}})}})}})},at=w('<svg><path stroke="currentColor" stroke-width="3px" d="M20,44c-0.256,0-0.512-0.098-0.707-0.293L4.586,29l14.707-14.707c0.391-0.391,1.023-0.391,1.414,0  s0.391,1.023,0,1.414L7.414,29l13.293,13.293c0.391,0.391,0.391,1.023,0,1.414C20.512,43.902,20.256,44,20,44z"></path></svg>',4,!0),lt=w('<svg><path stroke="currentColor" stroke-width="3px" d="M37,44c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414L49.586,29L36.293,15.707  c-0.391-0.391-0.391-1.023,0-1.414s1.023-0.391,1.414,0L52.414,29L37.707,43.707C37.512,43.902,37.256,44,37,44z"></path></svg>',4,!0),it=e=>t(Y,$({viewBox:"0 0 57 57"},e,{get children(){return[at.cloneNode(!0),lt.cloneNode(!0)]}})),ut=w("<span>Rows</span>",2),M=w("<span></span>",2),ct=w("<span>-</span>",2),Q=w("<span>of</span>",2),st=w("<span>&nbsp;</span>",2),j=[10,25,50,100],ht=e=>{const[d,s]=h(S.Loading),[f,l]=h([]),[a,o]=h(""),[c,C]=h(0),[m,te]=h(e.pageSizeOptions?.[0]??j[0]),[ne,H]=h(0),[re,D]=h(0),[R,I]=h(),[ae,p]=h(e.defaultItem??W),[z,y]=h();Fe(()=>{x()});const x=async()=>{const n=await e.crudService.readAll({page:c()+1,searchText:a()});if(n.isSuccess==!1){i.show({status:"danger",title:`Could not fetch all ${e.itemName}s`}),s(S.Error);return}y(void 0),e.serverPagination?(l(n.value.value),H(n.value.totalRows),D(n.value.totalPages),i.clear()):(C(0),l(n.value),H(n.value.length),D(Math.floor(n.value.length/m()))),s(S.Success)},le=(n,r)=>{let g=V(n,r);return e.serverPagination?g:g.slice(c()*m(),Math.min((c()+1)*m(),f().length))},V=(n,r)=>{if(e.serverPagination==!0)return n;let g=[];return e.searchFunc==null||r==null||r.length==0?g=n:g=n.filter(de=>e.searchFunc(de,r)),g},ie=async()=>{const n=await Je({title:"Please enter Guid",input:"text",focusOnInput:!0});i.show({status:"info",title:`Fetching info for ${e.itemName}`});const r=await e.crudService.read(n);if(r.isSuccess==!1){i.show({status:"danger",title:`Unable to find ${e.itemName} by Id`});return}I(r.value)},ue=async()=>{if(i.show({status:"info",title:`Creating ${e.itemName}`}),(await e.crudService.create(ae())).isSuccess==!1){i.show({status:"danger",title:`Unable to create ${e.itemName}`});return}else i.clear(),i.show({status:"success",title:`Created ${e.itemName} 🎉`});x()},ce=async()=>{const n=R();if(n==null){i.show({status:"danger",title:`Could not edit ${e.itemName}`});return}if(y(n.guid),I(void 0),i.show({status:"info",title:`Editing ${e.itemName}`}),await Xe(3e3),(await e.crudService.update(n)).isSuccess==!1){i.show({status:"danger",title:`Unable to update ${e.itemName}`}),y(void 0);return}else i.clear(),i.show({status:"success",title:`Edited ${e.itemName} 🎉`});x()},se=async n=>{if(i.show({status:"info",title:`Deleting ${e.itemName}`}),y(n.guid),(await e.crudService.del(n)).isSuccess==!1){i.show({status:"danger",title:`Could not delete ${e.itemName}`}),y(void 0);return}else i.clear(),i.show({status:"success",title:`Deleted ${e.itemName} 🎉`});x()},U=(n,r)=>(n??[])?.filter(g=>(g.hiddenIn??[]).includes(r)==!1),q={variant:"filled"};return[t(Le,{get text(){return e.title}}),t(b,{m:50}),t(u,{get when(){return d()==S.Loading||d()==S.Pending},get children(){return t(_e,{})}}),t(u,{get when(){return d()==S.Error},get children(){return t(J,{children:"Error"})}}),t(u,{get when(){return d()==S.Success},get children(){return[t(Z,{class:"section-read-all",get children(){return[t(u,{get when(){return e.searchFunc!=null},get children(){return t(O,{mb:"1em",get children(){return[t(u,{get when(){return e.disableGetByIdOption!=!0},get children(){return[t(B,{}),t(B,{}),t(E,{label:"Get item by guid",get children(){return t(b,{class:"pointer",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"10px",p:"5px 1em",display:"inline-block",onClick:ie,get children(){return t(it,{fontSize:"2em"})}})}})]}}),t(B,{}),t(je,{maxW:"400px",get children(){return[t(nt,{get condition(){return e.searchTooltip!=null},wrapComp:E,get wrapProps(){return{label:e.searchTooltip}},get children(){return t(We,$(q,{get children(){return t(Qe,{})}}))}}),t(He,$(q,{placeholder:"Search",get value(){return a()},type:"text",get onInput(){return De(n=>{o(n.target.value),x()})}}))]}})]}})}}),t(pe,{get striped(){return e.striped??"odd"},get highlightOnHover(){return e.highlightOnHover??!0},get dense(){return e.dense??!0},get children(){return[t(ze,{get children(){return t(F,{get children(){return[t(v,{get each(){return e.tableHeadItems},children:n=>t(L,{get class(){return n.classNames},get width(){return n.width},get maxWidth(){return n.maxWidth},get textAlign(){return n.textAlign},get children(){return t(_,{class:"clamp-to-2-lines",get children(){return n.title}})}})}),t(L,{textAlign:"center",children:"Actions"})]}})}}),t(Ve,{get children(){return t(v,{get each(){return le(f(),a())},children:n=>t(F,{get children(){return t(u,{get when(){return z()==null||z()!=n.guid},get fallback(){return t(X,{get colSpan(){return e.tableHeadItems.length+1},get children(){return t(J,{get children(){return t(Ue,{})}})}})},get children(){return[T(()=>e.tableRowRender(n)),t(X,{get children(){return t(ee,{justifyContent:"center",get children(){return t(v,{get each(){return[...e.disableCopyGuidAction?[]:[{emoji:"📋",label:"Copy Guid",order:1,onClick:r=>Ze(r.guid)}],...e.disableEditAction?[]:[{emoji:"📝",label:"Edit",order:5,onClick:r=>I(r)}],...e.disableDeleteAction?[]:[{emoji:"🚮",label:"Delete",order:99,onClick:r=>se(r)}],...e.actionsPerRow??[]]},children:r=>t(E,{get label(){return r.label},placement:"top",get children(){return t(_,{class:"pointer action-item",size:"xl",get order(){return r.order},onClick:()=>r.onClick(n),get children(){return r.emoji}})}})})}})}})]}})}})})}}),t(u,{get when(){return e.tableFooterItems!=null},get children(){return t(qe,{get children(){return t(F,{get children(){return t(v,{get each(){return e.tableFooterItems},children:n=>t(L,{get class(){return n.classNames},get children(){return n.title}})})}})}})}})]}}),t(O,{justifyContent:"end",mt:"$3",get children(){return[t(b,{mx:"1em",get children(){return[t(A,{minWidth:"75px",mx:"0.25em",get disabled(){return c()<1},onClick:()=>{C(n=>n-1),e.serverPagination&&(i.show({status:"info",title:"Loading page"}),x())},children:"<"}),t(A,{minWidth:"75px",mx:"0.25em",get disabled(){return T(()=>e.serverPagination!=!1)()&&c()>=Math.floor(f().length/m())||e.serverPagination==!0&&c()>=re()},onClick:()=>{C(n=>n+1),e.serverPagination&&(i.show({status:"info",title:"Loading page"}),x())},children:">"})]}}),t(u,{get when(){return(e.pageSizeOptions??j).length>1},get children(){return t(O,{mx:"1em",get children(){return[t(_,{children:"Page size: "}),t(tt,{title:"Page size",hideTitle:!0,get selectedValues(){return[m().toString()]},onSelect:n=>{Array.isArray(n)||te(parseInt(n))},get options(){return(e.pageSizeOptions??j).map(n=>({title:n.toString(),value:n.toString()}))}})]}})}}),t(b,{mx:"1em",get children(){return[ut.cloneNode(!0)," ",(()=>{const n=M.cloneNode(!0);return N(n,()=>c()*m()+1),n})()," ",ct.cloneNode(!0)," ",t(u,{get when(){return e.unknownPagination!=!0},get fallback(){return[(()=>{const n=st.cloneNode(!0),r=n.firstChild;return N(n,()=>(c()+1)*m(),r),n})(),Q.cloneNode(!0)," ",(()=>{const n=M.cloneNode(!0);return N(n,ne),n})()]},get children(){return[(()=>{const n=M.cloneNode(!0);return N(n,()=>Math.min(f().length,(c()+1)*m())),n})()," ",Q.cloneNode(!0)," ",(()=>{const n=M.cloneNode(!0);return N(n,()=>V(f(),a()).length),n})()]}})]}})]}})]}}),t(u,{get when(){return e.children!=null},get children(){return[t(b,{m:"2em"}),T(()=>e.children)]}}),t(b,{m:"2em"}),t(u,{get when(){return U(e.propToFormMappings,k.Add)?.length>0},get children(){return t(Z,{class:"section-create",get children(){return[t(Ge,{mb:"1.5em",children:"Create new record"}),t(K,{get mode(){return k.Add},get item(){return e.defaultItem??W},get mappings(){return e.propToFormMappings},updateObject:n=>p(r=>n),updateProperty:(n,r)=>{console.log("create",{prop:n,value:r}),p(g=>({...g,[n]:r}))}}),t(O,{justifyContent:"center",mt:"2em",get children(){return t(A,{onClick:ue,get children(){return["Add ",T(()=>e.itemName)]}})}})]}})}}),t(b,{m:"8em"}),t(u,{get when(){return U(e.propToFormMappings,k.Edit)?.length>0},get children(){return t(rt,{get title(){return`Edit - ${e.title}`},get isOpen(){return R()!=null},onSave:ce,onClose:()=>I(void 0),get children(){return t(K,{get mode(){return k.Edit},get item(){return R()},get mappings(){return e.propToFormMappings},updateObject:n=>I(r=>n),updateProperty:(n,r)=>{console.log("update",{prop:n,value:r}),I(g=>(console.log({...g}),{...g,[n]:r}))}})}})}})]}})]};export{it as C,tt as D,P as G,ht as M,Qe as S,k as a,Ze as c};
