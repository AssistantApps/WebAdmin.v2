import{S as p,C as w,l as f,u as m,a as _,o as b,r as y,c as s,P as S,B as v,b as O,d as u,e as E,H as T,t as J}from"./index-fca7416d.js";import{g as C,a as R,N as i,C as A}from"./assistantAppsApiService-0f362fab.js";new TextEncoder;const h=new TextDecoder,P=t=>{const e=atob(t),o=new Uint8Array(e.length);for(let r=0;r<e.length;r++)o[r]=e.charCodeAt(r);return o},I=t=>{let e=t;e instanceof Uint8Array&&(e=h.decode(e)),e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return P(e)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}};class W extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){var o;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,(o=Error.captureStackTrace)===null||o===void 0||o.call(Error,this,this.constructor)}}class a extends W{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}function j(t){return typeof t=="object"&&t!==null}function N(t){if(!j(t)||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}const L=I;function x(t){if(typeof t!="string")throw new a("JWTs must use Compact JWS serialization, JWT must be a string");const{1:e,length:o}=t.split(".");if(o===5)throw new a("Only JWTs using Compact JWS serialization can be decoded");if(o!==3)throw new a("Invalid JWT");if(!e)throw new a("JWTs must contain a payload");let r;try{r=L(e)}catch{throw new a("Failed to parse the base64url encoded payload")}let n;try{n=JSON.parse(h.decode(r))}catch{throw new a("Failed to parse the decoded payload as JSON")}if(!N(n))throw new a("Invalid JWT Claims Set");return n}var B=Object.defineProperty,D=Object.getOwnPropertyDescriptor,G=(t,e,o,r)=>{for(var n=r>1?void 0:r?D(e,o):e,c=t.length-1,l;c>=0;c--)(l=t[c])&&(n=(r?l(e,o,n):l(n))||n);return r&&n&&B(e,o,n),n};let d=class{_config;_aaService;constructor(){this._config=C(),this._aaService=R()}init=(t,e)=>{window.google.accounts.id.initialize({client_id:this._config.getGoogleClientId(),callback:this.handleResponse(t,e)})};initButton=(t,e,o)=>{this.init(e,o),window.google.accounts.id.renderButton(document.getElementById(t),{theme:"filled_black",size:"large",shape:"pill",text:"continue_with"})};promptUser=()=>{window.google.accounts.id.prompt()};handleResponse=(t,e)=>async o=>{t();const r=x(o.credential),n={accessToken:o.credential,email:r.email,oAuthType:f.OAuthProviderType.google,profileUrl:r.picture,tokenId:o.credential,username:r.name};(await this._aaService.loginWithGoogleAuth(n)).isSuccess&&e()}};d=G([p()],d);const g=()=>w.get(d),U=J('<div id="buttonDiv"></div>',2),H=()=>{const t=m(),[e,o]=_(i.Success);return b(()=>{g().initButton("buttonDiv",()=>{o(i.Loading)},()=>{o(i.Success),t(y.dashboard,{replace:!0})}),setTimeout(()=>{g().promptUser()},1e3)}),[s(S,{text:"Login"}),s(v,{m:50}),s(u,{get when(){return e()==i.Loading},get children(){return s(O,{})}}),s(u,{get when(){return e()==i.Success},get children(){return s(E,{minH:"50vh",get children(){return s(A,{get children(){return[s(T,{mb:"1em",children:"Login using Google"}),U.cloneNode(!0)]}})}})}})]};export{H as LoginPage,H as default};
